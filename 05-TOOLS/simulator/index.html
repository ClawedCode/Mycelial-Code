<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mycelial Simulator - Network Visualization & Execution</title>

  <!-- D3.js -->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <!-- CodeMirror for code editing -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/simple.min.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/editor.css">
  <link rel="stylesheet" href="styles/graph.css">
</head>
<body>
  <div id="app">
    <!-- Header with controls -->
    <header id="header" class="header">
      <div class="header-section">
        <h1>üß¨ Mycelial Simulator</h1>
        <p>Bio-inspired distributed computation visualization</p>
      </div>

      <div class="header-controls">
        <button id="btn-load-file" class="btn btn-primary">üìÇ Load File</button>
        <input id="file-input" type="file" accept=".mycelial" style="display: none;">

        <button id="btn-parse" class="btn btn-secondary" disabled>‚úì Parse</button>
        <button id="btn-reset" class="btn btn-secondary" disabled>‚Ü∫ Reset</button>

        <div class="separator"></div>

        <button id="btn-step" class="btn btn-success" disabled>‚è≠ Step</button>
        <button id="btn-play" class="btn btn-success" disabled>‚ñ∂ Play</button>
        <button id="btn-pause" class="btn btn-success" disabled style="display: none;">‚è∏ Pause</button>

        <div class="cycle-info">
          <span>Cycle:</span>
          <span id="cycle-count">0</span>
          <span id="phase-info">(‚Äî)</span>
        </div>

        <div class="speed-control">
          <label for="speed-slider">Speed:</label>
          <input id="speed-slider" type="range" min="1" max="10" value="5">
        </div>
      </div>

      <div id="error-panel" class="error-panel" style="display: none;">
        <button id="btn-close-errors" class="btn-close">√ó</button>
        <div id="error-list"></div>
      </div>
    </header>

    <!-- Main content -->
    <main id="main" class="main">
      <!-- Left panel: Code editor -->
      <div id="editor-panel" class="panel editor-panel">
        <div class="panel-header">
          <h2>Mycelial Program</h2>
          <p class="help-text">Load a .mycelial file or select an example</p>
        </div>
        <div id="example-selector" class="example-selector">
          <label for="examples">Example:</label>
          <select id="examples">
            <option value="">‚Äî Select Example ‚Äî</option>
            <option value="hello_world.mycelial">Hello World</option>
            <option value="pipeline.mycelial">Pipeline (3-stage)</option>
            <option value="map_reduce.mycelial">Map-Reduce</option>
            <option value="distributed_search.mycelial">Distributed Search</option>
            <option value="consensus.mycelial">Consensus</option>
          </select>
        </div>
        <div id="editor-container" class="editor-container">
          <textarea id="code-editor"></textarea>
        </div>
      </div>

      <!-- Right panel: Visualization -->
      <div id="viz-panel" class="panel viz-panel">
        <div class="panel-header">
          <h2>Network Topology</h2>
          <p class="help-text">Nodes are hyphae, edges are signal paths</p>
        </div>
        <div id="graph-container" class="graph-container">
          <div class="placeholder">
            <p>Load a program to visualize the network topology</p>
            <p>üëá Try the <strong>Hello World</strong> example above</p>
          </div>
        </div>
      </div>
    </main>

    <!-- Bottom panel: State inspector -->
    <div id="inspector-panel" class="panel inspector-panel">
      <div class="panel-header">
        <h2>State Inspector</h2>
        <p id="inspector-info" class="help-text">Click on a node to view its state</p>
      </div>
      <div id="inspector-content" class="inspector-content">
        <div class="placeholder">
          <p>No agent selected</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Application scripts -->
  <script src="src/parser/lexer.js"></script>
  <script src="src/parser/ast.js"></script>
  <script src="src/parser/parser.js"></script>

  <script src="src/analyzer/symbol-table.js"></script>
  <script src="src/analyzer/type-checker.js"></script>
  <script src="src/analyzer/topology-validator.js"></script>

  <script src="src/runtime/hyphal-agent.js"></script>
  <script src="src/runtime/signal-router.js"></script>
  <script src="src/runtime/evaluator.js"></script>
  <script src="src/runtime/scheduler.js"></script>

  <script src="src/visualizer/graph-renderer.js"></script>
  <script src="src/visualizer/animation.js"></script>
  <script src="src/visualizer/state-inspector.js"></script>

  <script src="src/ui/controls.js"></script>
  <script src="src/ui/app.js"></script>
</body>
</html>
